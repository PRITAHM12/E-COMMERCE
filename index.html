<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RAJ ELECTRIC AND ELECTRONICS</title>
  <meta name="description" content="RAJ ELECTRIC AND ELECTRONICS - Demo store" />
  <style>
    /* =========================
       Base + UI/UX enhancements
       ========================= */
    :root{
      --brand:#0ea5a4; --accent:#7c3aed; --muted:#6b7280; --bg-soft:#f8fafc;
      --card-bg:#ffffff; --glass:rgba(255,255,255,0.6); --shadow-1:0 6px 18px rgba(15,23,42,0.06);
      --shadow-2:0 10px 30px rgba(15,23,42,0.08); --radius:12px; --ease:cubic-bezier(.2,.9,.3,1);
      --max-width:1180px; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{ height:100%; margin:0; background:linear-gradient(180deg,var(--bg-soft),#fff 60%); color:#0f172a; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    a{ color:inherit; text-decoration:none; }
    .container{ max-width:var(--max-width); margin:0 auto; padding:18px; }

    /* Header */
    header.header{
      position:sticky; top:0; z-index:60;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 18px; background:linear-gradient(90deg, rgba(255,255,255,0.72), rgba(255,255,255,0.88));
      backdrop-filter: blur(6px);
      border-bottom: 1px solid rgba(15,23,42,0.04); box-shadow:var(--shadow-1);
    }
    .brand{ font-weight:800; color:var(--brand); letter-spacing:0.2px; display:flex; gap:8px; align-items:center; font-size:18px; }
    nav.header-nav{ display:flex; gap:12px; align-items:center; }

    /* Search */
    .search { position:relative; display:flex; align-items:center; gap:8px; }
    .search input{
      width:360px; max-width:44vw; padding:10px 12px; border-radius:10px; border:1px solid rgba(2,6,23,0.06);
      background:linear-gradient(180deg,#fff,#fbfeff); transition: box-shadow .22s var(--ease), transform .18s var(--ease);
      font-size:14px;
    }
    .search input:focus{ box-shadow: 0 6px 20px rgba(14,165,164,0.08); transform: translateY(-1px); outline:none; }
    .search-suggestions{ position:absolute; left:0; right:0; top:48px; background:var(--card-bg); border-radius:10px; box-shadow:var(--shadow-2); overflow:hidden; z-index:80; display:none; }
    .search-suggestions.active{ display:block; }
    .search-suggestions button{ width:100%; text-align:left; padding:8px 12px; border:none; background:transparent; cursor:pointer; font-size:14px; }
    .search-suggestions button:hover{ background:rgba(14,165,164,0.04); }

    /* Layout */
    .layout{ display:flex; gap:18px; margin-top:18px; align-items:flex-start; }
    .sidebar{ width:260px; background:var(--card-bg); border:1px solid rgba(2,6,23,0.04); padding:12px; border-radius:12px; height:fit-content; box-shadow:0 6px 12px rgba(2,6,23,0.02); }
    .main{ flex:1; }

    /* Grid and card */
    .grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:14px; }
    .card{ background:var(--card-bg); border-radius:12px; padding:10px; border:1px solid rgba(2,6,23,0.03);
      transition: transform .22s var(--ease), box-shadow .22s var(--ease); box-shadow: 0 4px 14px rgba(2,6,23,0.03); display:flex; flex-direction:column; gap:8px; min-height:220px;
    }
    .card:hover{ transform: translateY(-6px); box-shadow:var(--shadow-2); }
    .thumb{ height:160px; border-radius:10px; overflow:hidden; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,#f8fafc,#fff); }
    .thumb img{ max-width:100%; max-height:100%; object-fit:contain; }

    .meta{ display:flex; justify-content:space-between; gap:12px; align-items:flex-start; }
    .title{ font-weight:700; font-size:14px; color:#0f172a; }
    .price{ color:var(--brand); font-weight:800; }
    .hint{ color:var(--muted); font-size:13px; }

    .actions{ display:flex; gap:8px; margin-top:auto; }
    .btn-ghost{ background:transparent; border:1px solid rgba(2,6,23,0.06); padding:8px 10px; border-radius:8px; cursor:pointer; }
    .btn-primary{ background:var(--brand); color:#fff; padding:8px 12px; border-radius:8px; border:none; cursor:pointer; }

    /* Product detail */
    .product-row{ display:flex; gap:24px; align-items:flex-start; }
    .product-gallery{ flex:0 0 46%; border-radius:12px; padding:12px; background:linear-gradient(180deg,#fff,#fbfeff); border:1px solid rgba(2,6,23,0.03); }
    .product-info{ flex:1; }

    /* Cart panel */
    .cart-panel{ position:fixed; right:20px; bottom:20px; width:380px; max-height:80vh; border-radius:12px; overflow:hidden; transform-origin:100% 100%; transition: transform .28s var(--ease), opacity .22s var(--ease); box-shadow:var(--shadow-2); background:var(--card-bg); border:1px solid rgba(2,6,23,0.04); z-index:90; }
    .cart-panel.closed{ transform: translateY(20px) scale(.98); opacity:0; pointer-events:none; }
    .cart-panel.open{ transform: translateY(0) scale(1); opacity:1; pointer-events:auto; }
    .cart-header{ display:flex; justify-content:space-between; padding:12px; border-bottom:1px solid rgba(2,6,23,0.03); align-items:center; }
    .cart-item{ display:flex; gap:8px; padding:10px 12px; border-bottom:1px dashed rgba(2,6,23,0.03); align-items:center; }

    /* Footer */
    footer{ margin-top:28px; padding:16px; text-align:center; color:var(--muted); font-size:13px; background:transparent; }

    /* responsive */
    @media (max-width:980px){
      .search input{ width:220px; }
      .layout{ flex-direction:column; }
      .sidebar{ width:100%; order:2; }
      .cart-panel{ left:12px; right:12px; width:auto; bottom:12px; }
      .product-row{ flex-direction:column; }
    }

    /* dark theme toggle style */
    :root[data-theme="dark"]{
      --bg-soft:#071027; --card-bg:#071827; --brand:#34d399; --muted:#9aa4b2; color:#e6eef8;
    }
    :root[data-theme="dark"] body{ background:linear-gradient(180deg,#031026,#071027 60%); color:#e6eef8; }
  </style>
</head>
<body>
  <!-- SVG symbols -->
  <svg style="display:none" aria-hidden="true">
    <symbol id="icon-search" viewBox="0 0 24 24"><path fill="currentColor" d="M21 21l-4.35-4.35"></path><circle cx="11" cy="11" r="6" fill="none" stroke="currentColor" stroke-width="2"></circle></symbol>
    <symbol id="icon-cart" viewBox="0 0 24 24"><path fill="currentColor" d="M7 4h-2l-1 2h2l3.6 7.59-1.35 2.44C8.89 16.37 9.35 17 10 17h8v-2h-7.42c-.14 0-.25-.11-.25-.25l.03-.12L13.1 11h4.45c.75 0 1.41-.41 1.75-1.03L22 4H7z" /></symbol>
    <symbol id="icon-theme" viewBox="0 0 24 24"><path fill="currentColor" d="M12 3a1 1 0 0 1 1 1v1a1 1 0 0 1-2 0V4a1 1 0 0 1 1-1zM4 11a1 1 0 0 1 1-1h1a1 1 0 1 1 0 2H5a1 1 0 0 1-1-1zM20 11a1 1 0 0 1-1 1h-1a1 1 0 1 1 0-2h1a1 1 0 0 1 1 1zM7.05 6.05a1 1 0 0 1 1.41 0l.7.7a1 1 0 1 1-1.41 1.41l-.7-.7a1 1 0 0 1 0-1.41zM16.84 15.84a1 1 0 0 1 1.41 0l.7.7a1 1 0 1 1-1.41 1.41l-.7-.7a1 1 0 0 1 0-1.41z"/></symbol>
  </svg>

  <header class="header">
    <div style="display:flex;align-items:center;gap:12px">
      <a class="brand" href="#" data-link="/">RAJ ELECTRIC AND ELECTRONICS</a>
      <div class="search" role="search" aria-label="Product search">
        <input id="uxSearchInput" type="text" placeholder="Search products, brands, categories" autocomplete="off" aria-label="Search products"/>
        <div class="search-suggestions" id="uxSearchSuggestions" role="listbox" aria-label="Search suggestions"></div>
      </div>
    </div>
    <nav class="header-nav">
      <button id="uxThemeToggle" class="btn-ghost" aria-pressed="false" title="Toggle theme"><svg width="16" height="16"><use href="#icon-theme"></use></svg></button>
      <button id="uxOpenCartBtn" class="btn-ghost" title="Open cart"><svg width="16" height="16"><use href="#icon-cart"></use></svg></button>
      <a href="#" data-link="/admin" class="btn-ghost">Admin</a>
    </nav>
  </header>

  <main class="container" id="app"></main>

  <!-- Cart panel -->
  <div id="uxCartPanel" class="cart-panel closed" role="dialog" aria-label="Shopping cart" aria-hidden="true">
    <div class="cart-header">
      <strong>Cart</strong>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="uxCheckoutBtn" class="btn-primary">Checkout</button>
        <button id="uxCloseCart" class="btn-ghost" aria-label="Close cart">Close</button>
      </div>
    </div>
    <div id="uxCartContent" style="padding:12px; max-height:60vh; overflow:auto"></div>
    <div style="padding:12px; border-top:1px solid rgba(2,6,23,0.04); display:flex;justify-content:space-between;align-items:center">
      <div class="muted">Subtotal</div>
      <div id="uxCartSub" style="font-weight:800">₹0</div>
    </div>
  </div>

  <footer>
    <div><strong>RAJ ELECTRIC AND ELECTRONICS</strong></div>
    <div>Contact: 9934988962, 6200264347, 9534100325 | WhatsApp: 9534100325</div>
    <div>Email: Pritahmraj9935@gmail.com</div>
  </footer>

  <script>
  /* ======================
     Single-file SPA script
     ====================== */

  // Categories and brands
  const CATEGORIES = ['Voltage Regulators','Batteries','Inverters','Adapters','Cables','LED Bulbs','Switches','Meters','Sensors','Tools'];
  const BRANDS = ['RAJ','Energize','VoltPro','PowerX','LiteMax','DynoTech','Apex','Nova','ElectroHub','Prime'];

  // generate products (520)
  function placeholderImage(text, idx){
    const bg = ['#eef2ff','#ecfeff','#fff7ed','#fef2f2','#f0fdf4'][idx%5];
    const color = '#0f172a';
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='600'><rect width='100%' height='100%' fill='${bg}'/><text x='50%' y='45%' dominant-baseline='middle' text-anchor='middle' font-family='Arial' font-size='34' fill='${color}'>${escapeXml(text)}</text><text x='50%' y='65%' dominant-baseline='middle' text-anchor='middle' font-family='Arial' font-size='20' fill='${color}'>RAJ ELECTRIC</text></svg>`;
    return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
  }
  function escapeXml(s){ return s.replace(/[&<>'"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;',"'":'&apos;','"':'&quot;'})[c]); }
  function generateProducts(){
    const items = [];
    for(let i=1;i<=520;i++){
      const category = CATEGORIES[i % CATEGORIES.length];
      const brand = BRANDS[i % BRANDS.length];
      const title = `${brand} ${category} Model ${1000 + i}`;
      const slug = title.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
      const price = Math.round((Math.random()*14800) + 200);
      items.push({
        _id: 'p' + i,
        title, slug,
        description: `High quality ${title} by ${brand}. Durable and reliable.`,
        price, currency: 'INR', images: [placeholderImage(title,i)],
        category, brand, stock: Math.floor(Math.random()*150), sku: 'SKU' + (10000 + i),
        attributes: { warranty: (1 + (i%3)) + ' years', color: (i%2? 'Black':'White') },
        rating: (Math.random()*2 + 3).toFixed(1)
      });
    }
    return items;
  }
  const PRODUCTS = generateProducts();

  // local storage keys
  const CART_KEY = 'raj_cart_v1';
  const ORDERS_KEY = 'raj_orders_v1';

  // cart helpers
  function loadCart(){ try{return JSON.parse(localStorage.getItem(CART_KEY) || '[]'); }catch(e){ return []; } }
  function saveCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)); renderUxCart(); }
  function loadOrders(){ try{return JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]'); }catch(e){ return []; } }
  function saveOrders(o){ localStorage.setItem(ORDERS_KEY, JSON.stringify(o)); }

  // router
  function navigate(path){
    history.pushState({}, '', path);
    renderRoute();
  }
  window.addEventListener('popstate', renderRoute);
  document.addEventListener('click', e=>{
    const a = e.target.closest('[data-link]');
    if(a){ e.preventDefault(); navigate(a.getAttribute('data-link')); }
  });

  // search suggestions
  const uxSearchInput = document.getElementById('uxSearchInput');
  const uxSearchSuggestions = document.getElementById('uxSearchSuggestions');
  uxSearchInput.addEventListener('input', e=>{
    const q = e.target.value.trim().toLowerCase();
    if(!q){ uxSearchSuggestions.classList.remove('active'); uxSearchSuggestions.innerHTML=''; return; }
    const suggestions = PRODUCTS.filter(p=> (p.title + ' ' + p.brand + ' ' + p.category).toLowerCase().includes(q)).slice(0,6);
    uxSearchSuggestions.innerHTML = suggestions.map(p=> `<button data-slug="${p.slug}">${p.title} <span class="muted">• ${p.brand}</span></button>`).join('');
    uxSearchSuggestions.classList.add('active');
    uxSearchSuggestions.querySelectorAll('button').forEach(b=> b.addEventListener('click', ()=> { navigate('/product/' + b.getAttribute('data-slug')); uxSearchSuggestions.classList.remove('active'); }));
  });
  uxSearchInput.addEventListener('keydown', e=>{
    if(e.key === 'Enter'){ navigate('/?q=' + encodeURIComponent(uxSearchInput.value.trim())); uxSearchSuggestions.classList.remove('active'); }
    if(e.key === 'Escape'){ uxSearchSuggestions.classList.remove('active'); uxSearchInput.blur(); }
  });

  // theme toggle
  document.getElementById('uxThemeToggle').addEventListener('click', e=>{
    const root = document.documentElement;
    const dark = root.getAttribute('data-theme') === 'dark';
    if(dark){ root.removeAttribute('data-theme'); e.target.setAttribute('aria-pressed','false'); }
    else{ root.setAttribute('data-theme','dark'); e.target.setAttribute('aria-pressed','true'); }
  });

  // cart panel controls
  const uxCartPanel = document.getElementById('uxCartPanel');
  const uxCartContent = document.getElementById('uxCartContent');
  const uxCartSub = document.getElementById('uxCartSub');
  const uxCloseCart = document.getElementById('uxCloseCart');
  const uxOpenCartBtn = document.getElementById('uxOpenCartBtn');
  const uxCheckoutBtn = document.getElementById('uxCheckoutBtn');

  uxOpenCartBtn.addEventListener('click', ()=> uxOpenCart());
  uxCloseCart.addEventListener('click', ()=> uxClose());
  uxCheckoutBtn.addEventListener('click', ()=> { uxClose(); navigate('/checkout'); });

  function uxOpenCart(){ uxCartPanel.classList.remove('closed'); uxCartPanel.classList.add('open'); uxCartPanel.setAttribute('aria-hidden','false'); renderUxCart(); }
  function uxClose(){ uxCartPanel.classList.add('closed'); uxCartPanel.classList.remove('open'); uxCartPanel.setAttribute('aria-hidden','true'); }

  function renderUxCart(){
    const cart = loadCart();
    uxCartContent.innerHTML = '';
    if(cart.length === 0){ uxCartContent.innerHTML = '<div class="center muted small">Your cart is empty</div>'; uxCartSub.innerText='₹0'; return; }
    let total = 0;
    cart.forEach((it, idx) => {
      const p = PRODUCTS.find(x=>x._id===it.productId) || {};
      total += (it.price||p.price||0) * it.qty;
      const row = document.createElement('div'); row.className = 'cart-item';
      row.innerHTML = `
        <img src="${it.image || p.images?.[0] || ''}" alt="" style="width:72px;height:56px;object-fit:cover;border-radius:8px" />
        <div style="flex:1;min-width:0">
          <div style="font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:220px">${it.title}</div>
          <div class="muted small">₹${it.price}</div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
          <input aria-label="Quantity" type="number" min="1" value="${it.qty}" data-idx="${idx}" style="width:64px;padding:6px;border-radius:6px;border:1px solid rgba(2,6,23,0.06)" />
          <button class="btn-ghost" data-remove="${idx}">Remove</button>
        </div>
      `;
      uxCartContent.appendChild(row);
    });
    uxCartSub.innerText = '₹' + total;
    uxCartContent.querySelectorAll('input[type="number"]').forEach(inp=>{
      inp.addEventListener('change', e=>{
        const idx = Number(e.target.getAttribute('data-idx')); const q = Math.max(1, Number(e.target.value)||1);
        const c = loadCart(); c[idx].qty = q; saveCart(c);
      });
    });
    uxCartContent.querySelectorAll('button[data-remove]').forEach(b=>{
      b.addEventListener('click', ()=>{ const idx = Number(b.getAttribute('data-remove')); const c = loadCart(); c.splice(idx,1); saveCart(c); });
    });
  }

  // add to cart
  function addToCart(productId, qty = 1){
    const p = PRODUCTS.find(x=>x._id===productId);
    if(!p) return alert('Product not found');
    const c = loadCart();
    const found = c.find(i=>i.productId===productId);
    if(found){ found.qty = Math.min(found.qty + qty, 999); } else { c.push({ productId, title: p.title, price: p.price, image: p.images[0], qty }); }
    saveCart(c); uxOpenCart();
  }
  window.addToCart = addToCart; // exposed for templates

  // router render
  function renderRoute(){
    const path = location.pathname;
    const params = new URLSearchParams(location.search);
    const app = document.getElementById('app');
    if(path === '/' || path.startsWith('/?')){ const q = params.get('q') || ''; renderHome(app, { q }); }
    else if(path.startsWith('/product/')){ const slug = path.replace('/product/',''); renderProduct(app, slug); }
    else if(path === '/cart'){ renderCartPage(app); }
    else if(path === '/checkout'){ renderCheckout(app); }
    else if(path.startsWith('/order-success/')){ const id = path.replace('/order-success/',''); renderOrderSuccess(app, id); }
    else if(path === '/admin'){ renderAdmin(app); }
    else { renderNotFound(app); }
    renderUxCart();
  }
  window.addEventListener('popstate', renderRoute);

  /* ---------- Home / Listing ---------- */
  function renderHome(container, opts = {}) {
    const q = (opts.q || '').toLowerCase();
    let filtered = PRODUCTS.filter(p => {
      if(q) return (p.title + ' ' + p.category + ' ' + p.brand).toLowerCase().includes(q);
      return true;
    });
    container.innerHTML = `
      <div class="layout">
        <aside class="sidebar">
          <div style="font-weight:700;margin-bottom:8px">Filters</div>
          <label class="hint">Category
            <select id="filterCategory"><option value="">All</option>${CATEGORIES.map(c=>`<option>${c}</option>`).join('')}</select>
          </label>
          <label class="hint" style="margin-top:8px">Brand
            <select id="filterBrand"><option value="">All</option>${BRANDS.map(b=>`<option>${b}</option>`).join('')}</select>
          </label>
          <label class="hint" style="margin-top:8px">Price min
            <input id="filterMin" type="number" placeholder="0" />
          </label>
          <label class="hint" style="margin-top:8px">Price max
            <input id="filterMax" type="number" placeholder="20000" />
          </label>
          <div style="margin-top:10px; display:flex; gap:8px;">
            <button id="applyFilters" class="btn-ghost">Apply</button>
            <button id="resetFilters" class="btn-ghost">Reset</button>
          </div>
          <hr style="margin:12px 0" />
          <div class="small muted">Showing <strong id="countProducts"></strong> products</div>
          <div style="margin-top:12px;" class="muted small">Tip: Click a product to open details. Use search or filters to narrow results.</div>
        </aside>
        <section class="main">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px">
            <input id="homeSearch" type="text" placeholder="Search products..." style="flex:1;padding:10px;border-radius:10px;border:1px solid rgba(2,6,23,0.06)" />
            <button id="openCart" class="btn-ghost">Open Cart</button>
          </div>
          <div id="productGrid" class="grid"></div>
        </section>
      </div>
    `;
    document.getElementById('homeSearch').value = q;
    document.getElementById('openCart').addEventListener('click', ()=> uxOpenCart());
    document.getElementById('applyFilters').addEventListener('click', apply);
    document.getElementById('resetFilters').addEventListener('click', ()=>{ document.getElementById('filterCategory').value=''; document.getElementById('filterBrand').value=''; document.getElementById('filterMin').value=''; document.getElementById('filterMax').value=''; renderGrid(PRODUCTS); });
    document.getElementById('homeSearch').addEventListener('keydown', e=> { if(e.key==='Enter'){ navigate('/?q=' + encodeURIComponent(document.getElementById('homeSearch').value.trim())); } });

    function apply(){
      const cat = document.getElementById('filterCategory').value;
      const brand = document.getElementById('filterBrand').value;
      const min = Number(document.getElementById('filterMin').value || 0);
      const max = Number(document.getElementById('filterMax').value || 1e9);
      const qv = (document.getElementById('homeSearch').value || '').toLowerCase();
      const list = PRODUCTS.filter(p=>{
        if(cat && p.category !== cat) return false;
        if(brand && p.brand !== brand) return false;
        if(p.price < min || p.price > max) return false;
        if(qv && !(p.title + ' ' + p.brand + ' ' + p.category).toLowerCase().includes(qv)) return false;
        return true;
      });
      renderGrid(list);
    }

    function renderGrid(list){
      const grid = document.getElementById('productGrid');
      grid.innerHTML = '';
      document.getElementById('countProducts').innerText = list.length;
      list.forEach(p=>{
        const div = document.createElement('div'); div.className = 'card';
        div.innerHTML = `
          <a href="#" data-link="/product/${p.slug}" style="text-decoration:none;color:inherit">
            <div class="thumb"><img loading="lazy" src="${p.images[0]}" alt="${p.title}" /></div>
            <div class="meta">
              <div style="flex:1">
                <div class="title">${p.title}</div>
                <div class="hint">${p.brand} • ${p.category}</div>
              </div>
              <div style="text-align:right">
                <div class="price">₹${p.price}</div>
                <div class="hint">⭐ ${p.rating}</div>
              </div>
            </div>
          </a>
          <div class="actions">
            <button class="btn-ghost" data-link="/product/${p.slug}">View</button>
            <button class="btn-primary quick-add" data-id="${p._id}">Add</button>
          </div>
        `;
        grid.appendChild(div);
      });
      grid.querySelectorAll('button.quick-add').forEach(b=> b.addEventListener('click', ()=> addToCart(b.getAttribute('data-id'))));
    }

    renderGrid(filtered);
  }

  /* ---------- Product detail ---------- */
  function renderProduct(container, slug){
    const prod = PRODUCTS.find(p=>p.slug === slug);
    if(!prod){ renderNotFound(container); return; }
    container.innerHTML = `
      <div class="product-row">
        <div class="product-gallery">
          <img src="${prod.images[0]}" alt="${prod.title}" style="width:100%;height:360px;object-fit:contain;border-radius:8px;background:#fff;padding:12px" />
        </div>
        <div class="product-info">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <div>
              <div style="font-size:20px;font-weight:800">${prod.title}</div>
              <div class="hint">${prod.brand} • ${prod.category}</div>
            </div>
            <div style="text-align:right">
              <div class="price" style="font-size:20px">₹${prod.price}</div>
              <div class="hint">SKU: ${prod.sku}</div>
            </div>
          </div>
          <div style="margin-top:8px">${prod.description}</div>
          <div style="margin-top:8px" class="hint">Attributes: ${Object.entries(prod.attributes).map(([k,v])=>k+': '+v).join(' • ')}</div>
          <div style="margin-top:12px; display:flex; gap:8px; align-items:center;">
            <input id="buyQty" type="number" value="1" min="1" style="width:80px;padding:8px;border-radius:8px;border:1px solid rgba(2,6,23,0.06)" />
            <button id="addCartBtn" class="btn-primary">Add to cart</button>
            <button id="buyNowBtn" class="btn-ghost">Buy now</button>
          </div>
          <div style="margin-top:12px">
            <div class="hint">Rating: ⭐ ${prod.rating}</div>
            <div class="hint" style="margin-top:6px">Stock: ${prod.stock} units</div>
          </div>
        </div>
      </div>
    `;
    document.getElementById('addCartBtn').addEventListener('click', ()=>{
      const q = Math.max(1, Number(document.getElementById('buyQty').value)||1);
      addToCart(prod._id, q); alert('Added to cart');
    });
    document.getElementById('buyNowBtn').addEventListener('click', ()=>{
      const q = Math.max(1, Number(document.getElementById('buyQty').value)||1);
      addToCart(prod._id, q); navigate('/checkout');
    });
  }

  /* ---------- Cart page ---------- */
  function renderCartPage(container){
    const cart = loadCart();
    container.innerHTML = `
      <div style="background:var(--card-bg);padding:12px;border-radius:12px;border:1px solid rgba(2,6,23,0.04)">
        <h2>Shopping Cart</h2>
        <div id="cartFull"></div>
        <div style="text-align:right;margin-top:12px">
          <button class="btn-ghost" data-link="/">Continue Shopping</button>
          <button id="checkoutNow" class="btn-primary">Checkout</button>
        </div>
      </div>
    `;
    document.querySelector('[data-link="/"]').addEventListener('click', e=> { e.preventDefault(); navigate('/'); });
    document.getElementById('checkoutNow').addEventListener('click', ()=> navigate('/checkout'));
    const box = document.getElementById('cartFull');
    function render(){
      if(cart.length===0){ box.innerHTML = '<div class="center muted">Your cart is empty</div>'; return; }
      box.innerHTML = ''; let total=0;
      cart.forEach((it, idx)=>{
        const p = PRODUCTS.find(x=>x._id===it.productId) || {};
        const row = document.createElement('div'); row.style.display='flex'; row.style.justifyContent='space-between'; row.style.gap='8px'; row.style.padding='8px 0'; row.style.borderBottom='1px solid rgba(2,6,23,0.04)';
        row.innerHTML = `
          <div style="flex:1">
            <div style="font-weight:700">${it.title || p.title}</div>
            <div class="hint">${p.brand || ''} • ${p.category || ''}</div>
          </div>
          <div style="width:160px;text-align:right">
            <div>₹${it.price}</div>
            <div style="margin-top:6px;">
              <input type="number" value="${it.qty}" min="1" data-idx="${idx}" style="width:80px;padding:6px;border-radius:6px;border:1px solid rgba(2,6,23,0.06)" />
              <button data-remove="${idx}" class="btn-ghost" style="margin-left:6px">Remove</button>
            </div>
          </div>
        `;
        box.appendChild(row);
        total += (it.price || p.price || 0) * it.qty;
      });
      const tot = document.createElement('div'); tot.style.textAlign='right'; tot.style.marginTop='12px'; tot.innerHTML = `<div style="font-weight:700">Total: ₹${total}</div>`;
      box.appendChild(tot);

      box.querySelectorAll('input[type="number"]').forEach(inp=>{
        inp.addEventListener('change', e=>{
          const idx = Number(e.target.getAttribute('data-idx')); const q = Math.max(1, Number(e.target.value)||1);
          const c = loadCart(); c[idx].qty = q; saveCart(c); render();
        });
      });
      box.querySelectorAll('button[data-remove]').forEach(btn=>{
        btn.addEventListener('click', ()=>{ const idx = Number(btn.getAttribute('data-remove')); const c = loadCart(); c.splice(idx,1); saveCart(c); render(); });
      });
    }
    render();
  }

  /* ---------- Checkout ---------- */
  function renderCheckout(container){
    const cart = loadCart();
    if(cart.length === 0){ container.innerHTML = `<div class="center">Your cart is empty<div style="margin-top:12px"><button class="btn-ghost" data-link="/">Shop now</button></div></div>`; return; }
    const total = cart.reduce((s,i)=>s + (i.price||0)*i.qty, 0);
    container.innerHTML = `
      <div style="display:flex;gap:16px;flex-wrap:wrap;">
        <div style="flex:1;min-width:320px;background:var(--card-bg);padding:12px;border-radius:12px;border:1px solid rgba(2,6,23,0.04)">
          <h3>Shipping details</h3>
          <label class="hint">Full name<input id="shipName" type="text" /></label>
          <label class="hint">Phone<input id="shipPhone" type="text" /></label>
          <label class="hint">Address<textarea id="shipAddress"></textarea></label>
          <label class="hint">City / State<input id="shipCity" type="text" /></label>
          <label class="hint">Pincode<input id="shipPin" type="text" /></label>
        </div>
        <div style="width:360px;background:var(--card-bg);padding:12px;border-radius:12px;border:1px solid rgba(2,6,23,0.04)">
          <h3>Order summary</h3>
          <div id="checkoutItems" style="max-height:260px;overflow:auto"></div>
          <div style="display:flex;justify-content:space-between;margin-top:8px"><div class="hint">Subtotal</div><div class="price">₹${total}</div></div>
          <div style="margin-top:8px" class="hint">Payment: Cash on delivery (demo)</div>
          <div style="margin-top:12px; display:flex; gap:8px;">
            <button id="placeOrderBtn" class="btn-primary" style="flex:1">Place order</button>
            <button id="backToShop" class="btn-ghost">Back</button>
          </div>
        </div>
      </div>
    `;
    const list = document.getElementById('checkoutItems'); cart.forEach(it=>{
      const p = PRODUCTS.find(x=>x._id===it.productId) || {};
      const row = document.createElement('div'); row.style.display='flex'; row.style.justifyContent='space-between'; row.style.padding='6px 0'; row.innerHTML = `<div>${it.title} x ${it.qty}</div><div>₹${(it.price||p.price)*it.qty}</div>`;
      list.appendChild(row);
    });
    document.getElementById('backToShop').addEventListener('click', ()=> navigate('/'));
    document.getElementById('placeOrderBtn').addEventListener('click', ()=>{
      const name = document.getElementById('shipName').value.trim();
      const phone = document.getElementById('shipPhone').value.trim();
      const address = document.getElementById('shipAddress').value.trim();
      const city = document.getElementById('shipCity').value.trim();
      const pin = document.getElementById('shipPin').value.trim();
      if(!name || !phone || !address) return alert('Please fill name, phone, and address');
      const orders = loadOrders();
      const id = 'ORD' + Date.now().toString(36).toUpperCase();
      const order = { id, items: cart, total, shippingAddress: { name, phone, address, city, pin }, paymentStatus: 'COD', orderStatus: 'processing', createdAt: new Date().toISOString() };
      orders.unshift(order); saveOrders(orders); saveCart([]); navigate('/order-success/' + id); alert('Order placed: ' + id + ' (saved locally).');
    });
  }

  /* ---------- Order success ---------- */
  function renderOrderSuccess(container, id){
    const orders = loadOrders();
    const ord = orders.find(o=>o.id === id);
    container.innerHTML = `
      <div style="background:var(--card-bg);padding:18px;border-radius:12px;border:1px solid rgba(2,6,23,0.04)">
        <h2>Order confirmed</h2>
        <div style="margin-top:8px">Thank you for your order. <div class="muted">Order id: <strong>${id}</strong></div></div>
        <div style="margin-top:12px"><div><strong>Shipping:</strong></div><div class="muted">${ord ? formatAddress(ord.shippingAddress) : '—'}</div></div>
        <div style="margin-top:12px"><div><strong>Items</strong></div><div class="muted">${ord ? ord.items.map(i=>i.title + ' x' + i.qty).join('<br/>') : ''}</div></div>
        <div style="margin-top:14px"><button data-link="/" class="btn-ghost">Continue shopping</button></div>
      </div>
    `;
    function formatAddress(a){ return `${a.name}, ${a.address}, ${a.city} - ${a.pin}. Phone: ${a.phone}`; }
  }

  /* ---------- Admin (local-only demo) ---------- */
  function renderAdmin(container){
    const orders = loadOrders();
    const PIN = '4321';
    container.innerHTML = `
      <div style="background:var(--card-bg);padding:12px;border-radius:12px;border:1px solid rgba(2,6,23,0.04)">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div><h2>Admin Dashboard <span style="background:#fffbeb;color:#92400e;padding:6px 8px;border-radius:8px;font-weight:700">Demo</span></h2><div class="hint">Local-only admin. Orders are stored in browser localStorage.</div></div>
          <div><input id="adminPin" type="password" placeholder="Enter admin PIN" style="padding:8px;border-radius:8px;border:1px solid rgba(2,6,23,0.06)" /><button id="unlockAdmin" class="btn-ghost">Unlock</button></div>
        </div>
        <div id="adminArea" style="margin-top:12px;display:none">
          <h3>Orders <small class="muted">(${orders.length})</small></h3>
          <div id="ordersList"></div>
        </div>
      </div>
    `;
    document.getElementById('unlockAdmin').addEventListener('click', ()=>{
      const v = document.getElementById('adminPin').value;
      if(v !== PIN) return alert('Wrong PIN');
      document.getElementById('adminArea').style.display = 'block';
      renderOrdersList();
    });
    function renderOrdersList(){
      const list = document.getElementById('ordersList'); list.innerHTML = '';
      const ordersNow = loadOrders();
      ordersNow.forEach(o=>{
        const div = document.createElement('div'); div.style.borderBottom='1px solid rgba(2,6,23,0.04)'; div.style.padding='8px 0';
        div.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div style="font-weight:700">${o.id}</div>
              <div class="muted small">${new Date(o.createdAt).toLocaleString()}</div>
              <div class="muted small">Items: ${o.items.length} • Total: ₹${o.total}</div>
              <div class="muted small">Shipping: ${o.shippingAddress.name}, ${o.shippingAddress.city}</div>
            </div>
            <div style="text-align:right">
              <select data-id="${o.id}" class="statusSelect">
                <option ${o.orderStatus==='processing'?'selected':''}>processing</option>
                <option ${o.orderStatus==='shipped'?'selected':''}>shipped</option>
                <option ${o.orderStatus==='delivered'?'selected':''}>delivered</option>
                <option ${o.orderStatus==='cancelled'?'selected':''}>cancelled</option>
              </select>
              <div style="margin-top:8px"><button data-id="${o.id}" class="btn-ghost">View</button></div>
            </div>
          </div>
        `;
        list.appendChild(div);
      });
      list.querySelectorAll('.statusSelect').forEach(sel=> sel.addEventListener('change', ()=>{
        const id = sel.getAttribute('data-id'); const ordersNow = loadOrders(); const o = ordersNow.find(x=>x.id===id);
        if(o){ o.orderStatus = sel.value; saveOrders(ordersNow); alert('Status updated'); renderOrdersList(); }
      }));
      list.querySelectorAll('button[data-id]').forEach(btn=> btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('data-id'); const ordersNow = loadOrders(); const o = ordersNow.find(x=>x.id===id);
        if(!o) return; alert('Order ' + id + '\n\n' + 'Items:\n' + o.items.map(it=>it.title + ' x' + it.qty).join('\n') + '\n\nShip to: ' + o.shippingAddress.name + ', ' + o.shippingAddress.address);
      }));
    }
  }

  /* ---------- Not found ---------- */
  function renderNotFound(container){ container.innerHTML = `<div style="padding:40px;text-align:center">Page not found<br/><br/><button class="btn-ghost" data-link="/">Go home</button></div>`; }

  /* ---------- Start / helpers ---------- */
  function renderRouteInit(){ renderRoute(); document.querySelectorAll('[data-link]').forEach(a=> a.addEventListener('click', e=>{ e.preventDefault(); navigate(a.getAttribute('data-link')); })); }
  function renderRoute(){ const path = location.pathname; const params = new URLSearchParams(location.search); const app = document.getElementById('app');
    if(path === '/' || path.startsWith('/?')){ const q = params.get('q') || ''; renderHome(app, { q }); }
    else if(path.startsWith('/product/')){ renderProduct(app, path.replace('/product/','')); }
    else if(path === '/cart'){ renderCartPage(app); }
    else if(path === '/checkout'){ renderCheckout(app); }
    else if(path.startsWith('/order-success/')){ renderOrderSuccess(app, path.replace('/order-success/','')); }
    else if(path === '/admin'){ renderAdmin(app); }
    else renderNotFound(app);
    renderUxCart();
  }

  // minimal cart persistence across tabs
  window.addEventListener('storage', e=>{ if(e.key === CART_KEY || e.key === ORDERS_KEY) renderUxCart(); });

  // basic navigation on initial load
  (function init(){ renderRoute(); })();

  // expose navigate globally for inline links
  window.navigate = navigate;
  </script>
</body>
</html>
```