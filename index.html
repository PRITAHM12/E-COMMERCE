<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RAJ ELECTRIC AND ELECTRONICS</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Poppins:wght@600;700&display=swap" rel="stylesheet">

  <meta name="description" content="RAJ ELECTRIC AND ELECTRONICS - Catalog demo (hash-router, profile, cart, admin route)" />
  <style>
    :root{
      --bg-900:#031028;
      --bg-800:#07203a;
      --panel:rgba(255,255,255,0.03);
      --card:#ffffff;
      --muted:#9fb6c5;
      --accent:#0b71ff;
      --brand:#00c2a8;
      --radius:12px;
      --shadow-lg:0 20px 50px rgba(2,6,23,0.45);
      --max-w:1300px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:var(--muted);
    }

    html,body{ height:100%; margin:0; background:linear-gradient(180deg,var(--bg-900),var(--bg-800)); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    a{ color:inherit; text-decoration:none; }

    /* Top-left menu button */
    .top-left-menu-btn{
      position:fixed; left:18px; top:18px; z-index:140;
      width:56px; height:56px; border-radius:12px; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.04); cursor:pointer; box-shadow:0 10px 30px rgba(2,6,23,0.25);
    }
    .top-left-menu-btn svg{ color:#e8f6ff; width:22px; height:22px; }

    /* Drawer (menu) redesigned: clear layout, section dividers, larger tappable items, overlay */
    .drawer-overlay{ position:fixed; inset:0; background:rgba(0,0,0,0.44); z-index:145; display:none; }
    .drawer-overlay.open{ display:block; }

    .drawer{
      position:fixed; left:18px; top:86px; width:360px; max-width:calc(100% - 36px);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px; padding:16px; box-shadow:var(--shadow-lg); border:1px solid rgba(255,255,255,0.03);
      transform:translateX(-14px); opacity:0; pointer-events:none; transition:transform .22s cubic-bezier(.2,.9,.3,1),opacity .18s;
      z-index:150;
    }
    .drawer.open{ transform:translateX(0); opacity:1; pointer-events:auto; }
    .drawer h4{ margin:0 0 10px 0; color:#eaf6ff; font-family: Poppins, Inter, sans-serif; font-weight:700; font-size:18px; }
    .menu-section{ margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .menu-item{
      display:flex; align-items:center; gap:12px; padding:12px; border-radius:10px; cursor:pointer;
      color:var(--muted); border:1px solid rgba(255,255,255,0.02); background:transparent; font-size:14px;
    }
    .menu-item:hover{ background:rgba(11,113,255,0.06); color:#eaf6ff; transform:translateX(4px); transition:transform .14s; }
    .menu-item .icon{ width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.02); color:#eaf6ff; font-weight:700; }

    .drawer .divider{ height:1px; background:rgba(255,255,255,0.02); margin:12px 0; border-radius:2px; }

    .help-block{ background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005)); padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.02); color:var(--muted); font-size:13px; }

    /* header: made non-fixed so it scrolls away with page content (user requested header scroll) */
    header.header{
      position:relative; margin:18px 24px 0 96px; display:flex; align-items:center; gap:18px; padding:14px 18px; border-radius:12px;
      background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.03);
    }
    .brand{ display:flex; gap:12px; align-items:center; min-width:260px; cursor:pointer; }
    .brand .logo{ width:52px; height:52px; border-radius:12px; overflow:hidden; display:flex; align-items:center; justify-content:center; box-shadow:0 10px 30px rgba(11,113,255,0.08); background:linear-gradient(135deg,#ffd166,#ff6b6b); }
    .brand .title{ display:flex; flex-direction:column; line-height:1; }
    .brand .title .name{ font-family:Poppins, Inter, sans-serif; font-weight:700; color:#0b1622; font-size:16px }
    .brand .title .tag{ font-size:12px; color:#0b2b36 }

    .search{ flex:1; display:flex; align-items:center; gap:12px; }
    .search input{ width:100%; padding:12px 14px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:rgba(255,255,255,0.04); color:#021122; font-size:14px; }

    .header-actions{ display:flex; gap:10px; align-items:center; margin-left:auto; }
    .icon-btn{ width:46px; height:46px; display:flex; align-items:center; justify-content:center; border-radius:10px; background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted); cursor:pointer; }
    .icon-btn:hover{ color:#021122; border-color:rgba(11,113,255,0.28) }

    .notif-badge[data-count="0"]::after{ display:none; }
    .notif-badge::after{
      content:attr(data-count); display:inline-block; position:relative; margin-left:6px; background:#ff3b30; color:#fff; border-radius:999px; padding:2px 7px; font-size:12px; font-weight:700;
    }

    .avatar{ width:44px; height:44px; border-radius:10px; overflow:hidden; display:flex; align-items:center; justify-content:center; background:#f3f7fb; }
    .avatar img{ width:100%; height:100%; object-fit:cover; display:block }

    main.container{ max-width:var(--max-w); margin:28px auto 48px; padding:0 20px; }
    .hero{ display:flex; gap:26px; align-items:center; padding:26px; border-radius:14px; background:linear-gradient(90deg, rgba(11,113,255,0.06), rgba(0,194,168,0.03)); border:1px solid rgba(255,255,255,0.02); }
    .hero-left{ flex:1; }
    .hero h1{ margin:0 0 10px 0; font-size:30px; color:#021122; font-family:Poppins, Inter, sans-serif; letter-spacing:0.2px }
    .hero p{ margin:0 0 14px 0; color:#02313a; font-size:15px; max-width:720px }

    .grid-wrap{ margin-top:18px; display:flex; gap:20px; }
    .left-panel{ width:300px; min-width:220px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; padding:14px; border:1px solid rgba(255,255,255,0.03); color:var(--muted); }
    .main-area{ flex:1 }

    .product-grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:18px; margin-top:12px; }
    .product-card{ background:var(--card); color:#0f172a; border-radius:12px; padding:12px; box-shadow:0 10px 28px rgba(2,6,23,0.12); display:flex; flex-direction:column; gap:10px; min-height:260px; }
    .thumb{ height:180px; border-radius:10px; overflow:hidden; display:flex; align-items:center; justify-content:center; background:#f6f8fb }
    .thumb img{ max-width:100%; max-height:100%; object-fit:contain }

    footer{ color:rgba(234,246,255,0.5); text-align:center; margin-top:36px; padding-bottom:30px }

    @media (max-width:980px){
      .top-left-menu-btn{ left:12px; top:12px }
      .drawer{ left:12px; top:78px; width:calc(100% - 24px) }
      header.header{ margin:12px 12px 0 12px; flex-wrap:wrap }
      main.container{ margin:20px 12px 36px; padding:0 12px }
      .grid-wrap{ flex-direction:column }
      .left-panel{ width:100%; order:2 }
    }

  </style>
</head>
<body>

  <!-- Menu button -->
  <button id="uxMenuBtn" class="top-left-menu-btn" aria-label="Open menu" title="Menu">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M3 6h18M3 12h18M3 18h18" stroke="#021122"/>
    </svg>
  </button>

  <!-- Drawer overlay -->
  <div id="uxDrawerOverlay" class="drawer-overlay" aria-hidden="true"></div>

  <!-- Drawer -->
  <aside id="uxDrawer" class="drawer" role="navigation" aria-label="Site menu">
    <h4>Menu</h4>

    <div class="menu-section" role="menu">
      <div class="menu-item" data-action="categories" role="menuitem"><div class="icon">C</div><div><strong>All categories</strong><div style="font-size:12px;color:var(--muted)">Browse categories</div></div></div>
      <div class="menu-item" data-action="language" role="menuitem"><div class="icon">L</div><div><strong>Choose language</strong><div style="font-size:12px;color:var(--muted)">EN / HI (demo)</div></div></div>
      <div class="menu-item" data-action="orders" role="menuitem"><div class="icon">O</div><div><strong>My orders</strong><div style="font-size:12px;color:var(--muted)">View local orders</div></div></div>
      <div class="menu-item" data-action="coupons" role="menuitem"><div class="icon">Cp</div><div><strong>Coupons</strong><div style="font-size:12px;color:var(--muted)">Apply coupons</div></div></div>
      <div class="menu-item" data-action="cart" role="menuitem"><div class="icon">Ct</div><div><strong>My cart</strong><div style="font-size:12px;color:var(--muted)">Open cart</div></div></div>
      <div class="menu-item" data-action="wishlist" role="menuitem"><div class="icon">W</div><div><strong>My wishlist</strong><div style="font-size:12px;color:var(--muted)">Saved items</div></div></div>
      <div class="menu-item" data-action="account" role="menuitem"><div class="icon">A</div><div><strong>My account</strong><div style="font-size:12px;color:var(--muted)">Profile & settings</div></div></div>
      <div class="menu-item" data-action="notifications" role="menuitem"><div class="icon">N</div><div><strong>My notifications</strong><div style="font-size:12px;color:var(--muted)">Alerts & updates</div></div></div>
    </div>

    <div class="divider" role="separator"></div>

    <div style="margin-top:6px">
      <div style="font-weight:700;color:#eaf6ff;margin-bottom:8px">Help centre</div>
      <div class="help-block" role="form" aria-label="Help centre contact">
        <div style="font-weight:700;color:#eaf6ff">Owner / Support</div>
        <div style="margin-top:8px;font-size:14px;color:#021122"><strong>Mr. Pritam</strong></div>
        <div style="margin-top:6px;font-size:13px;color:var(--muted)">Phone: <strong style="color:#021122">9534100325</strong></div>
        <div style="margin-top:6px;font-size:13px;color:var(--muted)">WhatsApp: <strong style="color:#021122">9534100325, 6200264347</strong></div>
        <div style="margin-top:6px;font-size:13px;color:var(--muted)">Email: <strong style="color:#021122">pritahmraj9935@gmail.com</strong></div>
        <div style="margin-top:10px;display:flex;gap:8px;justify-content:flex-end">
          <button id="helpClose" style="background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:8px;cursor:pointer;color:var(--muted)">Close</button>
        </div>
      </div>
    </div>
  </aside>

  <!-- Header (not fixed so it scrolls away) -->
  <header class="header" role="banner" aria-label="Main header">
    <div class="brand" onclick="location.hash='/'" role="link" tabindex="0">
      <div class="logo" aria-hidden="true">
        <!-- Jolly RAJ logo: colorful, playful mark -->
        <svg width="48" height="48" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <linearGradient id="g1" x1="0" x2="1">
              <stop offset="0" stop-color="#ffb86b"/>
              <stop offset="1" stop-color="#ff6b6b"/>
            </linearGradient>
            <linearGradient id="g2" x1="0" x2="1">
              <stop offset="0" stop-color="#6ee7b7"/>
              <stop offset="1" stop-color="#0b71ff"/>
            </linearGradient>
          </defs>
          <rect width="120" height="120" rx="18" fill="url(#g1)"/>
          <circle cx="80" cy="36" r="22" fill="url(#g2)"/>
          <text x="36" y="74" font-family="Poppins,Inter,Arial" font-size="48" fill="#0b1622" font-weight="700">R</text>
        </svg>
      </div>
      <div class="title">
        <div class="name">RAJ ELECTRIC</div>
        <div class="tag">Electrical components & supplies</div>
      </div>
    </div>

    <div class="search" role="search" aria-label="Search products">
      <input id="uxSearch" placeholder="Search products, brands, categories" aria-label="Search products" />
    </div>

    <div class="header-actions" role="toolbar" aria-label="Header actions">
      <button id="uxNotifBtn" class="icon-btn notif-badge" title="Notifications" aria-haspopup="true" aria-expanded="false" data-count="2" aria-label="Notifications">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M15 17h5l-1.4-1.4A2 2 0 0 1 18 14.6V11a6 6 0 1 0-12 0v3c0 .5-.2 1.1-.6 1.4L4 17h5" stroke="#021122"/></svg>
      </button>

      <button id="uxOpenCart" class="icon-btn" title="Open cart" aria-label="Open cart">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M6 6h14l-1.5 9h-11z" stroke="#021122"/></svg>
      </button>

      <div class="avatar" title="Account">
        <button id="uxAvatarBtn" style="all:unset;cursor:pointer" aria-haspopup="true" aria-label="Open account">
          <img id="uxAvatarImg" src="" alt="Account avatar" />
        </button>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main class="container" id="app" role="main" aria-live="polite">
    <section class="hero" aria-label="Hero">
      <div class="hero-left">
        <h1>Electrical goods built for professionals and stores</h1>
        <p>Curated components, repo-hosted images, bulk-ready packs, fast local checkout demo. Use the menu to browse categories, manage account and contact support.</p>
        <div class="cta">
          <button id="uxShopNow" style="background:var(--brand);color:#021122;padding:12px 16px;border-radius:10px;border:none;cursor:pointer;font-weight:700">Shop now</button>
          <button id="uxHow" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:10px 14px;border-radius:10px;cursor:pointer">How it works</button>
        </div>
      </div>
      <div style="width:420px;display:flex;align-items:center;justify-content:center">
        <img alt="RAJ hero" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='840' height='520'><rect width='100%25' height='100%25' rx='16' fill='%230b71ff'/><text x='50%25' y='50%25' font-family='Poppins,Arial' font-size='36' fill='white' text-anchor='middle' dominant-baseline='middle'>RAJ ELECTRIC</text></svg>" style="width:100%;border-radius:12px;box-shadow:0 18px 40px rgba(11,113,255,0.14)" />
      </div>
    </section>

    <div class="grid-wrap" style="margin-top:20px">
      <aside class="left-panel" aria-label="Filters and admin quick access">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700;color:#021122">Filters</div>
          <div style="font-size:12px;color:var(--muted)" id="countProducts">0 products</div>
        </div>

        <div style="margin-top:12px">
          <label style="display:block;color:var(--muted);font-size:13px">Category
            <select id="filterCategory" style="width:100%;margin-top:8px;padding:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:#021122"></select>
          </label>
          <label style="display:block;margin-top:10px;color:var(--muted);font-size:13px">Brand
            <input id="filterBrand" style="width:100%;margin-top:8px;padding:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:#021122" placeholder="Brand name" />
          </label>
          <div style="display:flex;gap:10px;margin-top:12px">
            <button id="applyFilters" style="flex:1;background:var(--brand);color:#021122;padding:10px;border-radius:8px;border:none;cursor:pointer">Apply</button>
            <button id="resetFilters" style="flex:1;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:10px;border-radius:8px;cursor:pointer">Reset</button>
          </div>
        </div>

        <div class="admin-short" style="margin-top:14px;display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-size:13px;color:var(--muted)">Admin</div>
            <div style="font-size:12px;color:var(--muted)">Local admin panel</div>
          </div>
          <div>
            <button id="openAdminQuick" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:8px;border-radius:8px;cursor:pointer">Open</button>
          </div>
        </div>
      </aside>

      <section class="main-area" aria-label="Products">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h2 style="margin:0;color:#021122">Products</h2>
        </div>

        <div id="productGrid" class="product-grid" role="list"></div>
      </section>
    </div>
  </main>

  <!-- Floating cart panel -->
  <div id="uxCartPanel" style="position:fixed; right:20px; bottom:20px; width:380px; background:var(--card); color:#0f172a; border-radius:12px; box-shadow:0 20px 50px rgba(2,6,23,0.35); padding:12px; display:none; z-index:160" role="dialog" aria-label="Cart">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <strong>Cart</strong>
      <div style="display:flex;gap:8px">
        <button id="uxCheckoutBtn" style="background:var(--brand);color:#021122;padding:8px 12px;border-radius:8px;border:none;cursor:pointer">Checkout</button>
        <button id="uxCloseCart" style="background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px 10px;border-radius:8px;cursor:pointer">Close</button>
      </div>
    </div>
    <div id="uxCartContent" style="margin-top:10px;max-height:320px;overflow:auto"></div>
    <div style="display:flex;justify-content:space-between;margin-top:10px"><div style="color:#666">Subtotal</div><div id="uxCartSub" style="font-weight:800">₹0</div></div>
  </div>

  <footer style="margin-top:36px;text-align:center;color:rgba(234,246,255,0.5);padding-bottom:30px">© RAJ ELECTRIC AND ELECTRONICS</footer>

  <script>
  /* SPA: hash router, improved drawer, help details prefilled, header scrolls away, working admin */
  const CART_KEY = 'raj_cart_v1';
  const ORDER_KEY = 'raj_orders_v1';
  const AUTH_KEY = 'raj_auth_v1';

  const CATEGORIES = ['Voltage Regulators','Batteries','Inverters','Adapters','Cables','LED Bulbs','LED Tubes','Drivers','Fittings','Switches','Meters','Sensors','Tools','Headphones','Earphones','Datacables','Power Banks','Chargers','Surge Protectors','Extension Cords','Sockets','Connectors','Transformers','Relays','Industrial Lamps'];
  const BRANDS = ['RAJ','Energize','VoltPro','PowerX','LiteMax','DynoTech','Apex','Nova','ElectroHub','Prime','SoundWave','BassLab','CableCore','ChargePro','BrightLine'];

  function loadCart(){ try { return JSON.parse(localStorage.getItem(CART_KEY) || '[]'); } catch(e){ return []; } }
  function saveCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)); renderCartPanel(); }
  function loadOrders(){ try { return JSON.parse(localStorage.getItem(ORDER_KEY) || '[]'); } catch(e){ return []; } }
  function saveOrders(o){ localStorage.setItem(ORDER_KEY, JSON.stringify(o)); }
  function accountSave(profile){ localStorage.setItem(AUTH_KEY, JSON.stringify(profile)); refreshAvatar(); }
  function accountLoad(){ try { return JSON.parse(localStorage.getItem(AUTH_KEY) || 'null'); } catch(e) { return null; } }
  function accountLogout(){ localStorage.removeItem(AUTH_KEY); refreshAvatar(); }

  function slugify(s){ return (s||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,''); }
  function escapeXml(s){ return String(s||'').replace(/[&<>'"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;',"'":'&apos;','"':'&quot;'})[c]); }
  function placeholderImage(text, idx){
    const bg = ['#eef2ff','#ecfeff','#fff7ed'][idx%3];
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='1200' height='900'><rect width='100%' height='100%' fill='${bg}'/><text x='50%' y='48%' font-family='Inter,Arial' font-size='48' fill='#0f172a' text-anchor='middle' dominant-baseline='middle'>${escapeXml(text)}</text></svg>`;
    return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
  }

  function generateProducts(count=120){
    const items = [];
    for(let i=1;i<=count;i++){
      const category = CATEGORIES[i % CATEGORIES.length];
      const brand = BRANDS[i % BRANDS.length];
      const title = `${brand} ${category} Model ${1000 + i}`;
      items.push({
        _id: 'p' + i,
        title,
        slug: slugify(title),
        description: `High quality ${title} by ${brand}. Durable and reliable.`,
        price: Math.round((Math.random()*14800) + 200),
        currency: 'INR',
        images: [placeholderImage(title, i)],
        category, brand, stock: Math.floor(Math.random()*300), sku: 'SKU' + (10000 + i),
        attributes: { warranty: (1 + (i%3)) + ' years', color: (i%2? 'Black':'White') },
        rating: Number((Math.random()*2 + 3).toFixed(1)),
        createdAt: new Date().toISOString()
      });
    }
    return items;
  }

  async function loadProductsJsonSafe(){
    try {
      const url = './products_with_images_with_repo_images.json';
      const res = await fetch(url, { cache: 'no-store' });
      if (!res.ok) throw new Error('not found ' + res.status);
      const data = await res.json();
      window.PRODUCTS = Array.isArray(data) ? data : [];
      console.log('Loaded products JSON:', window.PRODUCTS.length);
    } catch (err) {
      console.warn('Products JSON load failed, using generator', err);
      if(!window.PRODUCTS || !window.PRODUCTS.length) window.PRODUCTS = generateProducts(120);
    }
  }

  /* Drawer wiring */
  const uxMenuBtn = document.getElementById('uxMenuBtn');
  const uxDrawer = document.getElementById('uxDrawer');
  const uxOverlay = document.getElementById('uxDrawerOverlay');
  uxMenuBtn.addEventListener('click', () => { uxDrawer.classList.toggle('open'); uxOverlay.classList.toggle('open'); uxOverlay.style.display = uxOverlay.classList.contains('open') ? 'block' : 'none'; });
  uxOverlay.addEventListener('click', () => { uxDrawer.classList.remove('open'); uxOverlay.classList.remove('open'); uxOverlay.style.display = 'none'; });
  document.getElementById('helpClose').addEventListener('click', ()=>{ uxDrawer.classList.remove('open'); uxOverlay.classList.remove('open'); uxOverlay.style.display = 'none'; });

  uxDrawer.querySelectorAll('.menu-item').forEach(item => {
    item.addEventListener('click', () => {
      const act = item.getAttribute('data-action');
      uxDrawer.classList.remove('open');
      uxOverlay.classList.remove('open');
      uxOverlay.style.display = 'none';
      handleMenuAction(act);
    });
  });

  function handleMenuAction(act){
    switch(act){
      case 'categories': alert('Categories:\\n' + CATEGORIES.join('\\n')); break;
      case 'language':
        const lang = prompt('Choose language code (en/hi). This demo does not fully localize.');
        if(lang) alert('Language set (demo): ' + lang);
        break;
      case 'orders': location.hash = '/account/orders'; break;
      case 'coupons': alert('No coupons available (demo)'); break;
      case 'cart': location.hash = '/cart'; break;
      case 'wishlist': alert('Wishlist is empty (demo)'); break;
      case 'account': location.hash = '/account/profile'; break;
      case 'notifications': showNotifications(); break;
      case 'help': uxDrawer.classList.add('open'); uxOverlay.classList.add('open'); uxOverlay.style.display = 'block'; break;
      default: break;
    }
  }

  /* Notifications */
  const uxNotifBtn = document.getElementById('uxNotifBtn');
  function showNotifications(){
    const list = ['Welcome to RAJ ELECTRIC demo', 'New arrivals have been added'];
    alert('Notifications:\\n' + list.join('\\n'));
    uxNotifBtn.setAttribute('data-count', '0');
  }
  uxNotifBtn.addEventListener('click', showNotifications);

  /* Avatar */
  function refreshAvatar(){
    const p = accountLoad();
    const img = document.getElementById('uxAvatarImg');
    if(!img) return;
    if(p && p.avatar) img.src = p.avatar;
    else img.src = 'data:image/svg+xml;utf8,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="7" r="3" fill="#021122"/><path d="M4 20c0-3.31 2.69-6 6-6s6 2.69 6 6" stroke="#021122" stroke-width="1.2" fill="none"/></svg>');
  }
  document.getElementById('uxAvatarBtn').addEventListener('click', ()=> { location.hash = '/account/profile'; });

  /* Cart panel */
  function renderCartPanel(){
    const panel = document.getElementById('uxCartPanel');
    const content = document.getElementById('uxCartContent');
    const sub = document.getElementById('uxCartSub');
    const cart = loadCart();
    if(!panel || !content) return;
    if(cart.length === 0){
      content.innerHTML = '<div style="padding:12px;color:#333">Your cart is empty</div>';
      sub.innerText = '₹0';
      panel.style.display = 'block';
      return;
    }
    content.innerHTML = '';
    let total = 0;
    cart.forEach((it, idx) => {
      total += (it.price || 0) * it.qty;
      const row = document.createElement('div');
      row.style.display = 'flex';
      row.style.justifyContent = 'space-between';
      row.style.padding = '10px 0';
      row.style.borderBottom = '1px solid rgba(0,0,0,0.06)';
      row.innerHTML = `<div style="flex:1"><div style="font-weight:700">${it.title}</div><div style="color:#666">₹${it.price}</div></div><div style="text-align:right">Qty ${it.qty}<div style="margin-top:6px">₹${(it.price || 0) * it.qty}</div></div>`;
      content.appendChild(row);
    });
    sub.innerText = '₹' + total;
    panel.style.display = 'block';
  }

  document.getElementById('uxOpenCart').addEventListener('click', ()=> renderCartPanel());
  document.getElementById('uxCloseCart').addEventListener('click', ()=> { document.getElementById('uxCartPanel').style.display = 'none'; });
  document.getElementById('uxCheckoutBtn').addEventListener('click', ()=> { document.getElementById('uxCartPanel').style.display = 'none'; location.hash = '/payment'; });

  /* Router */
  function currentRouteFromHash(){ const h = location.hash || '#/'; return h.startsWith('#') ? h.slice(1) : h; }
  function renderRoute(){
    const path = currentRouteFromHash();
    if(path === '/' || path.startsWith('/?')){ const params = new URLSearchParams(location.hash.split('?')[1] || ''); const q = params.get('q') || ''; return renderHome({q}); }
    if(path.startsWith('/product/')){ const slug = path.replace('/product/',''); return renderProduct(slug); }
    if(path === '/cart') return renderCartPage();
    if(path === '/payment') return renderPayment();
    if(path.startsWith('/order-success/')){ const id = path.replace('/order-success/',''); return renderOrderSuccess(id); }
    if(path === '/admin') return renderAdmin();
    if(path.startsWith('/account')){ const sub = path.replace('/account','').replace(/^\//,'') || 'profile'; return renderAccount(sub); }
    if(path.startsWith('/order/')){ const id = path.replace('/order/',''); return renderOrderDetail(id); }
    renderNotFound();
  }

  /* Renderers (same features) */
  function renderHome(opts = {}){
    const q = (opts.q || '').toLowerCase();
    const grid = document.getElementById('productGrid');
    const count = document.getElementById('countProducts');
    const products = (window.PRODUCTS || []).filter(p => { if(q) return (p.title + ' ' + p.brand + ' ' + p.category).toLowerCase().includes(q); return true; });

    // populate category select
    const sel = document.getElementById('filterCategory');
    if(sel && sel.options.length === 0){
      const frag = document.createDocumentFragment();
      const opt = document.createElement('option'); opt.value=''; opt.textContent='All'; frag.appendChild(opt);
      CATEGORIES.forEach(c => { const o = document.createElement('option'); o.textContent = c; frag.appendChild(o); });
      sel.appendChild(frag);
    }

    count.innerText = products.length + ' products';
    grid.innerHTML = '';
    products.forEach(p => {
      const card = document.createElement('div');
      card.className = 'product-card';
      card.innerHTML = `
        <a href="#/product/${p.slug}" data-link="#/product/${p.slug}" style="display:block;color:inherit">
          <div class="thumb"><img loading="lazy" src="${(p.images && p.images[0]) || ''}" alt="${escapeXml(p.title)}" /></div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
            <div style="max-width:60%"><div style="font-weight:700">${escapeXml(p.title)}</div><div style="font-size:12px;color:#6b7e8f">${escapeXml(p.brand)} • ${escapeXml(p.category)}</div></div>
            <div style="text-align:right"><div style="color:var(--accent);font-weight:800">₹${p.price}</div><div style="font-size:12px;color:#6b7e8f">⭐ ${p.rating}</div></div>
          </div>
        </a>
        <div style="display:flex;gap:10px;margin-top:8px">
          <button class="icon-add" data-id="${p._id}" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);cursor:pointer">Add</button>
          <button data-link="#/product/${p.slug}" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);cursor:pointer">View</button>
        </div>
      `;
      grid.appendChild(card);
    });

    grid.querySelectorAll('.icon-add').forEach(b => b.addEventListener('click', () => {
      const id = b.getAttribute('data-id');
      const p = (window.PRODUCTS || []).find(x => x._id === id);
      if(!p) return alert('Product not found');
      const c = loadCart();
      const found = c.find(i => i.productId === id);
      if(found) found.qty = Math.min(999, found.qty + 1); else c.push({ productId: id, title: p.title, price: p.price, image: p.images[0], qty: 1 });
      saveCart(c);
      renderCartPanel();
      alert('Added to cart');
    }));

    document.getElementById('applyFilters').onclick = () => {
      const cat = document.getElementById('filterCategory').value || '';
      const brand = document.getElementById('filterBrand').value.trim().toLowerCase() || '';
      const list = (window.PRODUCTS || []).filter(p => {
        if(cat && p.category !== cat) return false;
        if(brand && !((p.brand||'').toLowerCase().includes(brand))) return false;
        return true;
      });
      // re-render grid
      grid.innerHTML = '';
      list.forEach(p => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.innerHTML = `
          <a href="#/product/${p.slug}" data-link="#/product/${p.slug}" style="display:block;color:inherit">
            <div class="thumb"><img loading="lazy" src="${(p.images && p.images[0]) || ''}" alt="${escapeXml(p.title)}" /></div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
              <div style="max-width:60%"><div style="font-weight:700">${escapeXml(p.title)}</div><div style="font-size:12px;color:#6b7e8f">${escapeXml(p.brand)} • ${escapeXml(p.category)}</div></div>
              <div style="text-align:right"><div style="color:var(--accent);font-weight:800">₹${p.price}</div><div style="font-size:12px;color:#6b7e8f">⭐ ${p.rating}</div></div>
            </div>
          </a>
          <div style="display:flex;gap:10px;margin-top:8px">
            <button class="icon-add" data-id="${p._id}" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);cursor:pointer">Add</button>
            <button data-link="#/product/${p.slug}" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);cursor:pointer">View</button>
          </div>
        `;
        grid.appendChild(card);
      });
      grid.querySelectorAll('.icon-add').forEach(b => b.addEventListener('click', () => {
        const id = b.getAttribute('data-id');
        const p = (window.PRODUCTS || []).find(x => x._id === id);
        if(!p) return alert('Product not found');
        const c = loadCart();
        const found = c.find(i => i.productId === id);
        if(found) found.qty = Math.min(999, found.qty + 1); else c.push({ productId: id, title: p.title, price: p.price, image: p.images[0], qty: 1 });
        saveCart(c);
        renderCartPanel();
        alert('Added to cart');
      }));
    };

    document.getElementById('resetFilters').onclick = () => { document.getElementById('filterCategory').value = ''; document.getElementById('filterBrand').value = ''; renderRoute(); };
  }

  function renderProduct(slug){
    const product = (window.PRODUCTS || []).find(p => p.slug === slug);
    if(!product) return renderNotFound();
    const mainArea = document.querySelector('.main-area');
    mainArea.innerHTML = `
      <div style="display:flex;gap:22px;flex-wrap:wrap">
        <div style="flex:0 0 48%"><div style="background:var(--card);padding:12px;border-radius:12px"><img src="${product.images[0]}" alt="${escapeXml(product.title)}" style="width:100%;height:420px;object-fit:contain;border-radius:8px" /></div></div>
        <div style="flex:1">
          <h2 style="margin:0;color:#021122">${escapeXml(product.title)}</h2>
          <div style="color:var(--muted);margin-top:8px">${escapeXml(product.brand)} • ${escapeXml(product.category)}</div>
          <div style="margin-top:14px;background:linear-gradient(180deg, rgba(11,113,255,0.06), rgba(0,0,0,0.02));padding:12px;border-radius:10px;display:flex;justify-content:space-between;align-items:center">
            <div><div style="font-weight:800;color:var(--accent);font-size:22px">₹${product.price}</div><div style="color:var(--muted);margin-top:6px">SKU: ${product.sku}</div></div>
            <div style="display:flex;gap:10px">
              <button id="addToCartBtn" style="background:var(--accent);color:#fff;padding:10px 14px;border-radius:8px;border:none;cursor:pointer">Add to cart</button>
              <button id="buyNowBtn" style="background:transparent;border:1px solid rgba(255,255,255,0.04);padding:10px 14px;border-radius:8px;cursor:pointer">Buy now</button>
            </div>
          </div>
          <div style="margin-top:12px;color:var(--muted)">${escapeXml(product.description || '')}</div>
        </div>
      </div>
    `;
    document.getElementById('addToCartBtn').addEventListener('click', ()=> {
      const c = loadCart();
      const found = c.find(i => i.productId === product._id);
      if(found) found.qty = Math.min(999, found.qty + 1); else c.push({ productId: product._id, title: product.title, price: product.price, image: product.images[0], qty: 1 });
      saveCart(c); renderCartPanel(); alert('Added to cart');
    });
    document.getElementById('buyNowBtn').addEventListener('click', ()=> { const c = loadCart(); const found = c.find(i => i.productId === product._id); if(found) found.qty = Math.min(999, found.qty + 1); else c.push({ productId: product._id, title: product.title, price: product.price, image: product.images[0], qty: 1 }); saveCart(c); location.hash = '/payment'; });
  }

  function renderCartPage(){
    const mainArea = document.querySelector('.main-area');
    const cart = loadCart();
    if(!mainArea) return;
    if(cart.length === 0){ mainArea.innerHTML = `<div style="background:var(--card);padding:14px;border-radius:12px;color:#0f172a"><h3>Cart</h3><div>Your cart is empty</div></div>`; return; }
    let total = 0;
    const itemsHtml = cart.map((it, idx) => { total += it.price * it.qty; return `<div style="display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #eee"><div>${it.title} x ${it.qty}</div><div>₹${it.price * it.qty}</div></div>`; }).join('');
    mainArea.innerHTML = `<div style="background:var(--card);padding:14px;border-radius:12px;color:#0f172a"><h3>Cart</h3>${itemsHtml}<div style="text-align:right;margin-top:10px"><strong>Total ₹${total}</strong></div><div style="text-align:right;margin-top:12px"><button id="cartCheckoutBtn" style="background:var(--brand);color:#021122;padding:10px 14px;border-radius:8px;border:none;cursor:pointer">Checkout</button></div></div>`;
    document.getElementById('cartCheckoutBtn').addEventListener('click', ()=> location.hash = '/payment');
  }

  function renderPayment(){
    const mainArea = document.querySelector('.main-area');
    const cart = loadCart();
    if(!mainArea) return;
    if(cart.length === 0){ mainArea.innerHTML = `<div style="padding:20px;color:var(--muted)">Cart is empty</div>`; return; }
    const subtotal = cart.reduce((s, it)=> s + (it.price || 0) * it.qty, 0);
    const profile = accountLoad();
    mainArea.innerHTML = `
      <div style="display:flex;gap:18px;flex-wrap:wrap">
        <div style="flex:1;min-width:320px;background:var(--card);padding:14px;border-radius:12px">
          <h3>Shipping details</h3>
          <label style="display:block;margin-top:8px">Full name<input id="payName" value="${profile ? (profile.name || '') : ''}" style="width:100%;padding:10px;border-radius:8px" /></label>
          <label style="display:block;margin-top:8px">Phone<input id="payPhone" value="${profile ? (profile.phone || '') : ''}" style="width:100%;padding:10px;border-radius:8px" /></label>
          <label style="display:block;margin-top:8px">Address<textarea id="payAddress" style="width:100%;padding:10px;border-radius:8px"></textarea></label>
        </div>
        <div style="width:380px;background:var(--card);padding:14px;border-radius:12px">
          <h3>Order summary</h3>
          <div style="max-height:260px;overflow:auto">${cart.map(it=>`<div style="display:flex;justify-content:space-between;padding:6px 0">${it.title} x ${it.qty}<div>₹${it.price * it.qty}</div></div>`).join('')}</div>
          <div style="display:flex;justify-content:space-between;margin-top:8px"><div style="color:#666">Subtotal</div><div style="font-weight:800">₹${subtotal}</div></div>
          <div style="margin-top:12px"><button id="placeOrderBtn" style="background:var(--brand);color:#021122;padding:10px 12px;border-radius:8px;border:none;cursor:pointer;width:100%">Place order (COD)</button></div>
        </div>
      </div>
    `;
    document.getElementById('placeOrderBtn').addEventListener('click', ()=> {
      const name = document.getElementById('payName').value.trim();
      const phone = document.getElementById('payPhone').value.trim();
      const address = document.getElementById('payAddress').value.trim();
      if(!name || !phone || !address) return alert('Please fill name, phone and address');
      const orders = loadOrders();
      const id = 'ORD' + Date.now().toString(36).toUpperCase();
      const order = { id, items: loadCart(), total: subtotal, shippingAddress: { name, phone, address }, paymentStatus: 'COD', orderStatus: 'processing', createdAt: new Date().toISOString() };
      orders.unshift(order); saveOrders(orders); saveCart([]);
      alert('Order placed: ' + id);
      location.hash = '/order-success/' + id;
    });
  }

  function renderOrderSuccess(id){
    const mainArea = document.querySelector('.main-area');
    const orders = loadOrders();
    const ord = orders.find(o => o.id === id);
    mainArea.innerHTML = `<div style="background:var(--card);padding:14px;border-radius:12px;color:#0f172a"><h3>Order confirmed</h3><div style="margin-top:8px">Order id: <strong>${id}</strong></div><div style="margin-top:10px">Shipping: ${ord ? (ord.shippingAddress.name + ' • ' + ord.shippingAddress.address) : ''}</div><div style="margin-top:12px"><button style="background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px 12px;border-radius:8px;cursor:pointer" onclick="location.hash='/'">Continue shopping</button></div></div>`;
  }

  function renderAdmin(){
    const mainArea = document.querySelector('.main-area');
    const orders = loadOrders();
    mainArea.innerHTML = `
      <div style="background:var(--card);padding:14px;border-radius:12px;color:#0f172a">
        <h3>Admin panel (local demo)</h3>
        <div style="margin-top:8px;color:#666">Orders stored in browser (local only)</div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button id="exportOrders" style="background:var(--brand);color:#021122;padding:8px 12px;border-radius:8px;border:none;cursor:pointer">Export (console)</button>
          <button id="clearOrders" style="background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px 12px;border-radius:8px;cursor:pointer">Clear orders</button>
        </div>
        <div id="adminOrders" style="margin-top:12px;max-height:360px;overflow:auto"></div>
      </div>
    `;
    const list = document.getElementById('adminOrders');
    if(!orders.length) list.innerHTML = '<div style="color:#666">No orders</div>';
    else orders.forEach(o => {
      const div = document.createElement('div');
      div.style.borderBottom = '1px solid #eee'; div.style.padding = '10px 0';
      div.innerHTML = `<div style="display:flex;justify-content:space-between"><div><strong>${o.id}</strong><div style="color:#666;font-size:13px">${new Date(o.createdAt).toLocaleString()}</div></div><div>₹${o.total}</div></div><div style="margin-top:6px;color:#666">${o.items.map(i=>i.title+' x'+i.qty).join(', ')}</div>`;
      list.appendChild(div);
    });
    document.getElementById('exportOrders').addEventListener('click', ()=> {
      console.log('ORDERS EXPORT', loadOrders());
      alert('Orders exported to console (demo).');
    });
    document.getElementById('clearOrders').addEventListener('click', ()=> {
      if(!confirm('Clear all orders (local)?')) return;
      saveOrders([]);
      renderAdmin();
    });
  }

  function renderAccount(sub = 'profile'){
    const mainArea = document.querySelector('.main-area');
    const profile = accountLoad();
    if(!profile){
      mainArea.innerHTML = `<div style="background:var(--card);padding:14px;border-radius:12px;color:#0f172a"><h3>Account</h3><div style="margin-top:8px;color:#666">You are not logged in. Login (demo) with phone.</div><div style="margin-top:12px"><button id="demoLogin" style="background:var(--brand);color:#021122;padding:8px 12px;border-radius:8px;border:none;cursor:pointer">Login (demo)</button></div></div>`;
      document.getElementById('demoLogin').addEventListener('click', openOtpLogin);
      return;
    }

    if(sub === 'profile'){
      mainArea.innerHTML = `
        <div style="background:var(--card);padding:14px;border-radius:12px;color:#0f172a">
          <h3>Personal details</h3>
          <div style="display:flex;gap:12px">
            <div style="width:120px">
              <div style="width:120px;height:120px;border-radius:10px;overflow:hidden;background:#f6f8fb"><img id="profileAvatar" src="${profile.avatar || ''}" style="width:100%;height:100%;object-fit:cover" /></div>
              <input id="avatarFile" type="file" accept="image/*" style="margin-top:8px" />
            </div>
            <div style="flex:1">
              <label style="display:block">Full name<input id="profileName" value="${profile.name || ''}" style="width:100%;padding:10px;border-radius:8px" /></label>
              <label style="display:block;margin-top:8px">Phone<input id="profilePhone" value="${profile.phone || ''}" style="width:100%;padding:10px;border-radius:8px" /></label>
              <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
                <button id="saveProfile" style="background:var(--brand);color:#021122;padding:8px 12px;border-radius:8px;border:none;cursor:pointer">Save</button>
                <button id="logoutProfile" style="background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px 12px;border-radius:8px;cursor:pointer">Logout</button>
              </div>
            </div>
          </div>
        </div>
      `;
      document.getElementById('avatarFile').addEventListener('change', (e)=> {
        const f = e.target.files[0]; if(!f) return;
        const r = new FileReader(); r.onload = () => {
          const data = r.result; document.getElementById('profileAvatar').src = data;
          const updated = { name: document.getElementById('profileName').value || profile.name, phone: document.getElementById('profilePhone').value || profile.phone, avatar: data };
          accountSave(updated);
        }; r.readAsDataURL(f);
      });
      document.getElementById('saveProfile').addEventListener('click', ()=> {
        const name = document.getElementById('profileName').value.trim();
        const phone = document.getElementById('profilePhone').value.trim();
        if(!name || !phone) return alert('Name & phone required');
        const updated = { name, phone, avatar: (profile && profile.avatar) || '' };
        accountSave(updated); alert('Saved');
      });
      document.getElementById('logoutProfile').addEventListener('click', ()=> { accountLogout(); location.hash = '/'; });
      return;
    }

    if(sub === 'orders'){
      const orders = loadOrders();
      mainArea.innerHTML = `<div style="background:var(--card);padding:14px;border-radius:12px;color:#0f172a"><h3>My orders</h3><div id="ordersList" style="margin-top:12px"></div></div>`;
      const list = document.getElementById('ordersList');
      if(!orders.length) list.innerHTML = '<div style="color:#666">No orders</div>';
      else orders.forEach(o => {
        const el = document.createElement('div'); el.style.borderBottom = '1px solid #eee'; el.style.padding = '8px 0';
        el.innerHTML = `<div style="display:flex;justify-content:space-between"><div><strong>${o.id}</strong><div style="color:#666;font-size:13px">${new Date(o.createdAt).toLocaleString()}</div></div><div>₹${o.total}</div></div>`;
        list.appendChild(el);
      });
      return;
    }
  }

  function renderOrderDetail(id){
    const orders = loadOrders();
    const ord = orders.find(o => o.id === id);
    const mainArea = document.querySelector('.main-area');
    if(!ord){ mainArea.innerHTML = `<div style="padding:20px;color:var(--muted)">Order not found</div>`; return; }
    mainArea.innerHTML = `<div style="background:var(--card);padding:14px;border-radius:12px;color:#0f172a"><h3>Order ${ord.id}</h3><div style="margin-top:8px;color:#666">${new Date(ord.createdAt).toLocaleString()}</div><div style="margin-top:12px"><strong>Shipping</strong><div style="color:#666">${ord.shippingAddress.name}, ${ord.shippingAddress.address}</div></div><div style="margin-top:12px"><strong>Items</strong><div style="color:#666">${ord.items.map(i => i.title + ' x' + i.qty).join('<br/>')}</div></div></div>`;
  }

  function renderNotFound(){
    const mainArea = document.querySelector('.main-area');
    mainArea.innerHTML = `<div style="background:var(--card);padding:24px;border-radius:12px;color:#0f172a"><h3>Page not found</h3><div style="margin-top:12px"><button style="background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px 12px;border-radius:8px;cursor:pointer" onclick="location.hash='/'">Go home</button></div></div>`;
  }

  /* Simple OTP demo login */
  function openOtpLogin(){
    const phone = prompt('Enter phone (demo)');
    if(!phone) return;
    alert('Mock OTP sent: 123456');
    const otp = prompt('Enter OTP (123456)');
    if(otp !== '123456'){ alert('Wrong OTP'); return; }
    const profile = { name: 'User', phone, avatar: '' };
    accountSave(profile); location.hash = '/account/profile';
  }

  /* Boot */
  (function boot(){
    const appRoot = document.getElementById('app');
    if(appRoot) appRoot.insertAdjacentHTML('beforeend', '');
    loadProductsJsonSafe().then(()=> {
      refreshAvatar();
      if(!location.hash) location.hash = '/';
      renderRoute();
    }).catch(()=> { refreshAvatar(); if(!location.hash) location.hash = '/'; renderRoute(); });
    window.addEventListener('hashchange', renderRoute);
  })();

  /* Delegated links (data-link) */
  document.addEventListener('click', e => {
    const a = e.target.closest('[data-link]');
    if(!a) return;
    e.preventDefault();
    const link = a.getAttribute('data-link') || a.getAttribute('href');
    if(!link) return;
    if(link.startsWith('#')) location.hash = link.slice(1);
    else location.hash = link;
  });

  /* Search */
  (function wireSearch(){
    const input = document.getElementById('uxSearch');
    if(!input) return;
    input.addEventListener('keydown', e => {
      if(e.key === 'Enter'){ const q = input.value.trim(); location.hash = '/?q=' + encodeURIComponent(q); }
    });
  })();

  /* Admin quick open */
  document.getElementById('openAdminQuick').addEventListener('click', ()=> { location.hash = '/admin'; });

  /* Shop Now */
  document.getElementById('uxShopNow').addEventListener('click', ()=> { location.hash = '/'; });

  /* Utilities exposed */
  window._debug = { loadCart, saveCart, loadOrders, saveOrders, accountLoad, accountSave, setProducts: (p)=> { window.PRODUCTS = p; renderRoute(); } };
  </script>
</body>
</html>
```